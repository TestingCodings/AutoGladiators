<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
            xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
            x:Class="AutoGladiators.Client.Pages.BotDetailPage"
            Title="{Binding Bot.Name}"
            BackgroundColor="#0A0A0F">

    <ScrollView>
        <Grid RowDefinitions="Auto,Auto,Auto,*,Auto" Padding="15" RowSpacing="15">
            
            <!-- Hero Header Section -->
            <Frame Grid.Row="0" BackgroundColor="#1A1A2E" CornerRadius="20" Padding="20" HasShadow="True">
                <Grid ColumnDefinitions="100,*,Auto" RowDefinitions="Auto,Auto,Auto">
                    
                    <!-- Bot Avatar -->
                    <Frame Grid.Column="0" Grid.RowSpan="3" 
                           BackgroundColor="{Binding ElementColor}"
                           CornerRadius="15"
                           WidthRequest="90"
                           HeightRequest="90"
                           Padding="0"
                           HasShadow="True">
                        <Label Text="{Binding ElementIcon}" 
                               FontSize="40"
                               TextColor="White"
                               HorizontalTextAlignment="Center"
                               VerticalTextAlignment="Center"
                               FontAttributes="Bold"/>
                    </Frame>
                    
                    <!-- Bot Info -->
                    <StackLayout Grid.Column="1" Spacing="8" Margin="15,0,0,0">
                        <Label Text="{Binding Bot.Name}" 
                               FontSize="24" 
                               TextColor="#FFD700" 
                               FontAttributes="Bold"/>
                        <StackLayout Orientation="Horizontal" Spacing="10">
                            <Frame BackgroundColor="{Binding RarityColor}" 
                                   CornerRadius="8" 
                                   Padding="6,3"
                                   HasShadow="True">
                                <Label Text="{Binding BotRarity}" 
                                       FontSize="10" 
                                       TextColor="White" 
                                       FontAttributes="Bold"/>
                            </Frame>
                            <Label Text="{Binding Bot.ElementalCore}" 
                                   FontSize="12" 
                                   TextColor="{Binding ElementColor}"
                                   FontAttributes="Bold"
                                   VerticalTextAlignment="Center"/>
                        </StackLayout>
                        <Label Text="{Binding Bot.Description}" 
                               FontSize="12" 
                               TextColor="#B0B0B0"
                               LineBreakMode="WordWrap"/>
                    </StackLayout>
                    
                    <!-- Level and Power -->
                    <StackLayout Grid.Column="2" Spacing="5">
                        <Label Text="{Binding BotLevel}" 
                               FontSize="20" 
                               TextColor="#4A9EFF" 
                               FontAttributes="Bold"
                               HorizontalTextAlignment="End"/>
                        <Label Text="{Binding PowerRating, StringFormat='PWR: {0}'}" 
                               FontSize="12" 
                               TextColor="#FF6B6B"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="End"/>
                        <ProgressBar Progress="{Binding ExpProgress}" 
                                     ProgressColor="#00FF88"
                                     BackgroundColor="#2A2A3E"
                                     WidthRequest="80"
                                     HeightRequest="6"/>
                        <Label Text="{Binding ExpText}" 
                               FontSize="10" 
                               TextColor="#B0B0B0"
                               HorizontalTextAlignment="End"/>
                    </StackLayout>
                </Grid>
            </Frame>

            <!-- Stats Dashboard -->
            <Grid Grid.Row="1" ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                
                <!-- Primary Stats -->
                <Frame Grid.Column="0" BackgroundColor="#1A1A2E" CornerRadius="15" Padding="15">
                    <StackLayout>
                        <Label Text="Combat Stats" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="#FFD700" 
                               HorizontalTextAlignment="Center"
                               Margin="0,0,0,10"/>
                        
                        <!-- Health -->
                        <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,5">
                            <Label Grid.Column="0" Text="HP" FontSize="12" TextColor="#00FF88" FontAttributes="Bold"/>
                            <ProgressBar Grid.Column="1" Progress="{Binding HealthPercent}" 
                                         ProgressColor="#00FF88" BackgroundColor="#2A2A3E" 
                                         HeightRequest="6" Margin="10,0"/>
                            <Label Grid.Column="2" Text="{Binding HealthText}" FontSize="12" TextColor="#00FF88"/>
                        </Grid>
                        
                        <!-- Attack -->
                        <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,5">
                            <Label Grid.Column="0" Text="ATK" FontSize="12" TextColor="#FF4757" FontAttributes="Bold"/>
                            <ProgressBar Grid.Column="1" Progress="{Binding AttackPercent}" 
                                         ProgressColor="#FF4757" BackgroundColor="#2A2A3E" 
                                         HeightRequest="6" Margin="10,0"/>
                            <Label Grid.Column="2" Text="{Binding Bot.AttackPower}" FontSize="12" TextColor="#FF4757"/>
                        </Grid>
                        
                        <!-- Defense -->
                        <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,5">
                            <Label Grid.Column="0" Text="DEF" FontSize="12" TextColor="#4A9EFF" FontAttributes="Bold"/>
                            <ProgressBar Grid.Column="1" Progress="{Binding DefensePercent}" 
                                         ProgressColor="#4A9EFF" BackgroundColor="#2A2A3E" 
                                         HeightRequest="6" Margin="10,0"/>
                            <Label Grid.Column="2" Text="{Binding Bot.Defense}" FontSize="12" TextColor="#4A9EFF"/>
                        </Grid>
                        
                        <!-- Speed -->
                        <Grid ColumnDefinitions="Auto,*,Auto" Margin="0,5">
                            <Label Grid.Column="0" Text="SPD" FontSize="12" TextColor="#FFD700" FontAttributes="Bold"/>
                            <ProgressBar Grid.Column="1" Progress="{Binding SpeedPercent}" 
                                         ProgressColor="#FFD700" BackgroundColor="#2A2A3E" 
                                         HeightRequest="6" Margin="10,0"/>
                            <Label Grid.Column="2" Text="{Binding Bot.Speed}" FontSize="12" TextColor="#FFD700"/>
                        </Grid>
                    </StackLayout>
                </Frame>
                
                <!-- Secondary Stats -->
                <Frame Grid.Column="1" BackgroundColor="#1A1A2E" CornerRadius="15" Padding="15">
                    <StackLayout>
                        <Label Text="Attributes" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="#FFD700" 
                               HorizontalTextAlignment="Center"
                               Margin="0,0,0,10"/>
                        
                        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto" RowSpacing="8">
                            <Label Grid.Row="0" Grid.Column="0" Text="Energy:" FontSize="12" TextColor="#B0B0B0"/>
                            <Label Grid.Row="0" Grid.Column="1" Text="{Binding Bot.Energy}" FontSize="12" TextColor="#17A2B8" HorizontalTextAlignment="End"/>
                            
                            <Label Grid.Row="1" Grid.Column="0" Text="Endurance:" FontSize="12" TextColor="#B0B0B0"/>
                            <Label Grid.Row="1" Grid.Column="1" Text="{Binding Bot.Endurance}" FontSize="12" TextColor="#FFC107" HorizontalTextAlignment="End"/>
                            
                            <Label Grid.Row="2" Grid.Column="0" Text="Luck:" FontSize="12" TextColor="#B0B0B0"/>
                            <Label Grid.Row="2" Grid.Column="1" Text="{Binding Bot.Luck}" FontSize="12" TextColor="#E83E8C" HorizontalTextAlignment="End"/>
                            
                            <Label Grid.Row="3" Grid.Column="0" Text="Crit Rate:" FontSize="12" TextColor="#B0B0B0"/>
                            <Label Grid.Row="3" Grid.Column="1" Text="{Binding Bot.CriticalHitChance, StringFormat='{0:P1}'}" FontSize="12" TextColor="#DC3545" HorizontalTextAlignment="End"/>
                        </Grid>
                    </StackLayout>
                </Frame>
                
                <!-- Equipment Slots -->
                <Frame Grid.Row="1" Grid.ColumnSpan="2" BackgroundColor="#1A1A2E" CornerRadius="15" Padding="15">
                    <StackLayout>
                        <Label Text="Equipment" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="#FFD700" 
                               HorizontalTextAlignment="Center"
                               Margin="0,0,0,10"/>
                        
                        <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="10">
                            
                            <!-- Weapon Slot -->
                            <Button Grid.Column="0" 
                                    BackgroundColor="{Binding WeaponSlotColor}"
                                    CornerRadius="12"
                                    HeightRequest="70"
                                    Text="âš”ï¸"
                                    FontSize="24"
                                    TextColor="White"
                                    Clicked="OnEquipmentSlotClicked"
                                    CommandParameter="Weapon"/>
                            
                            <!-- Armor Slot -->
                            <Button Grid.Column="1" 
                                    BackgroundColor="{Binding ArmorSlotColor}"
                                    CornerRadius="12"
                                    HeightRequest="70"
                                    Text="ðŸ›¡ï¸"
                                    FontSize="24"
                                    TextColor="White"
                                    Clicked="OnEquipmentSlotClicked"
                                    CommandParameter="Armor"/>
                            
                            <!-- Accessory Slot -->
                            <Button Grid.Column="2" 
                                    BackgroundColor="{Binding AccessorySlotColor}"
                                    CornerRadius="12"
                                    HeightRequest="70"
                                    Text="ðŸ’"
                                    FontSize="24"
                                    TextColor="White"
                                    Clicked="OnEquipmentSlotClicked"
                                    CommandParameter="Accessory"/>
                            
                            <!-- Module Slot -->
                            <Button Grid.Column="3" 
                                    BackgroundColor="{Binding ModuleSlotColor}"
                                    CornerRadius="12"
                                    HeightRequest="70"
                                    Text="ðŸ”§"
                                    FontSize="24"
                                    TextColor="White"
                                    Clicked="OnEquipmentSlotClicked"
                                    CommandParameter="Module"/>
                        </Grid>
                        
                        <Grid ColumnDefinitions="*,*,*,*" Margin="0,5,0,0">
                            <Label Grid.Column="0" Text="Weapon" FontSize="10" TextColor="#B0B0B0" HorizontalTextAlignment="Center"/>
                            <Label Grid.Column="1" Text="Armor" FontSize="10" TextColor="#B0B0B0" HorizontalTextAlignment="Center"/>
                            <Label Grid.Column="2" Text="Accessory" FontSize="10" TextColor="#B0B0B0" HorizontalTextAlignment="Center"/>
                            <Label Grid.Column="3" Text="Module" FontSize="10" TextColor="#B0B0B0" HorizontalTextAlignment="Center"/>
                        </Grid>
                    </StackLayout>
                </Frame>
            </Grid>

            <!-- Status and Abilities -->
            <Grid Grid.Row="2" ColumnDefinitions="*,*" ColumnSpacing="10">
                
                <!-- Status Effects -->
                <Frame Grid.Column="0" BackgroundColor="#1A1A2E" CornerRadius="15" Padding="15">
                    <StackLayout>
                        <Label Text="Status Effects" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="#FFD700" 
                               HorizontalTextAlignment="Center"
                               Margin="0,0,0,10"/>
                        
                        <Label Text="{Binding StatusEffectsText}" 
                               FontSize="12" 
                               TextColor="#FFC107" 
                               HorizontalTextAlignment="Center"
                               LineBreakMode="WordWrap"/>
                    </StackLayout>
                </Frame>
                
                <!-- Battle Status -->
                <Frame Grid.Column="1" BackgroundColor="#1A1A2E" CornerRadius="15" Padding="15">
                    <StackLayout>
                        <Label Text="Battle Status" 
                               FontSize="16" 
                               FontAttributes="Bold" 
                               TextColor="#FFD700" 
                               HorizontalTextAlignment="Center"
                               Margin="0,0,0,10"/>
                        
                        <Label Text="{Binding BattleStatusText}" 
                               FontSize="12" 
                               TextColor="{Binding BattleStatusColor}" 
                               HorizontalTextAlignment="Center"
                               FontAttributes="Bold"/>
                        
                        <Label Text="{Binding LastBattleText}" 
                               FontSize="10" 
                               TextColor="#B0B0B0" 
                               HorizontalTextAlignment="Center"
                               Margin="0,5,0,0"/>
                    </StackLayout>
                </Frame>
            </Grid>

            <!-- Known Moves -->
            <Frame Grid.Row="3" BackgroundColor="#1A1A2E" CornerRadius="15" Padding="15">
                <StackLayout>
                    <Label Text="Known Abilities" 
                           FontSize="16" 
                           FontAttributes="Bold" 
                           TextColor="#FFD700" 
                           HorizontalTextAlignment="Center"
                           Margin="0,0,0,15"/>
                    
                    <CollectionView ItemsSource="{Binding BotMoves}" 
                                    HeightRequest="120">
                        <CollectionView.ItemsLayout>
                            <GridItemsLayout Orientation="Vertical" 
                                             Span="1" 
                                             VerticalItemSpacing="8"/>
                        </CollectionView.ItemsLayout>
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame BackgroundColor="#2A2A3E" 
                                       CornerRadius="10" 
                                       Padding="10"
                                       Margin="0,2">
                                    <Grid ColumnDefinitions="Auto,*,Auto">
                                        <Label Grid.Column="0" 
                                               Text="{Binding Icon}" 
                                               FontSize="16" 
                                               VerticalTextAlignment="Center"/>
                                        <Label Grid.Column="1" 
                                               Text="{Binding Name}" 
                                               FontSize="14" 
                                               TextColor="White" 
                                               FontAttributes="Bold"
                                               VerticalTextAlignment="Center"
                                               Margin="10,0,0,0"/>
                                        <Label Grid.Column="2" 
                                               Text="{Binding Power}" 
                                               FontSize="12" 
                                               TextColor="#FFC107" 
                                               VerticalTextAlignment="Center"/>
                                    </Grid>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>
            </Frame>

            <!-- Action Buttons -->
            <Grid Grid.Row="4" ColumnDefinitions="*,*,*" ColumnSpacing="10" Margin="0,10,0,0">
                <Button Grid.Column="0" 
                        Text="Level Up" 
                        BackgroundColor="#28A745" 
                        TextColor="White" 
                        CornerRadius="10"
                        FontAttributes="Bold"
                        Clicked="OnLevelUpClicked"/>
                
                <Button Grid.Column="1" 
                        Text="Battle Test" 
                        BackgroundColor="#4A9EFF" 
                        TextColor="White" 
                        CornerRadius="10"
                        FontAttributes="Bold"
                        Clicked="OnBattleTestClicked"/>
                
                <Button Grid.Column="2" 
                        Text="Customize" 
                        BackgroundColor="#6F42C1" 
                        TextColor="White" 
                        CornerRadius="10"
                        FontAttributes="Bold"
                        Clicked="OnCustomizeClicked"/>
            </Grid>
        </Grid>
    </ScrollView>
</ContentPage>
